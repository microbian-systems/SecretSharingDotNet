name: SecretSharingDotNet .NET FX

on:
  push:
    branches:
    - '*'
    tags-ignore:
    - '*'
    paths-ignore:
    - '**.md'

jobs:
  build:

    runs-on: windows-2019
    
    steps:
      - name: checkout
        uses: actions/checkout@v3

      - name: Setup Nuget.exe
        uses: nuget/setup-nuget@v1.1.1
        with:
          nuget-version: latest

      - name: Nuget Restore
        run: nuget restore $Env:GITHUB_WORKSPACE\SecretSharingDotNetFx4.6.2.sln

      - name: Build with mbsuild
        run: |
           cd "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\MSBuild\Current\Bin\"
           .\MSBuild.exe /p:Configuration=Release $Env:GITHUB_WORKSPACE\SecretSharingDotNetFx4.6.2.sln

      - name: Test with xUnit.net console runner
        run: |
           cd "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\MSBuild\Current\Bin\"
           .\MSBuild.exe /p:Configuration=Release $Env:GITHUB_WORKSPACE\tests\SecretSharingDotNetFx4.6.2Test.csproj /t:Test
